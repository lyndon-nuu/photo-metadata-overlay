# ä¿å­˜çŠ¶æ€æ˜¾ç¤ºä¿®å¤

## ğŸ¯ é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆï¼š**ç‚¹å‡»å›¾ç‰‡ä¸‹è½½ï¼Œä¸€ç›´æç¤ºä¿å­˜ä¸­ï¼Œç„¶åå›¾ç‰‡å·²ç»ä¿å­˜æˆåŠŸ**

è¿™æ˜¯ä¸€ä¸ªç”¨æˆ·ä½“éªŒé—®é¢˜ï¼šå›¾ç‰‡å®é™…ä¸Šå·²ç»ä¿å­˜æˆåŠŸäº†ï¼Œä½†æ˜¯UIçŠ¶æ€æ²¡æœ‰æ­£ç¡®æ›´æ–°ï¼Œå¯¼è‡´ä¸€ç›´æ˜¾ç¤º"ä¿å­˜ä¸­"çš„çŠ¶æ€ã€‚

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 
åœ¨ `useFileSave` hook ä¸­ï¼Œå½“åœ¨ **Tauri ç¯å¢ƒ**ä¸‹ä¿å­˜æˆåŠŸæ—¶ï¼Œç¼ºå°‘äº†çŠ¶æ€æ›´æ–°çš„å›è°ƒè°ƒç”¨ã€‚

### é—®é¢˜æµç¨‹
1. ç”¨æˆ·ç‚¹å‡»"ä¸‹è½½å¤„ç†åçš„å›¾ç‰‡"æŒ‰é’®
2. `useFileSave` hook å¼€å§‹ä¿å­˜ï¼Œè°ƒç”¨ `onSaveStart()` â†’ æ˜¾ç¤º"æ­£åœ¨ä¿å­˜å›¾ç‰‡..."
3. åœ¨ Tauri ç¯å¢ƒä¸‹ï¼Œæ–‡ä»¶ä¿å­˜æˆåŠŸ
4. **âŒ é—®é¢˜**ï¼šæ²¡æœ‰è°ƒç”¨ `onSaveSuccess()` å›è°ƒ
5. çŠ¶æ€æ ä¸€ç›´æ˜¾ç¤º"ä¿å­˜ä¸­"ï¼Œç”¨æˆ·ä½“éªŒä¸ä½³

### ä»£ç é—®é¢˜ä½ç½®
```typescript
// åœ¨ useFileSave.ts ä¸­ï¼ŒTauri ç¯å¢ƒçš„ä¿å­˜é€»è¾‘
const { writeFile } = await import('@tauri-apps/plugin-fs');
await writeFile(savePath, uint8Array);

return savePath; // âŒ ç›´æ¥è¿”å›ï¼Œæ²¡æœ‰è°ƒç”¨æˆåŠŸå›è°ƒ
```

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤å†…å®¹
åœ¨ Tauri ç¯å¢ƒçš„ä¿å­˜æˆåŠŸåï¼Œæ·»åŠ å®Œæ•´çš„çŠ¶æ€æ›´æ–°é€»è¾‘ï¼š

```typescript
// ä¿®å¤åçš„ä»£ç 
const { writeFile } = await import('@tauri-apps/plugin-fs');
await writeFile(savePath, uint8Array);

console.log('âœ… å›¾ç‰‡ä¿å­˜æˆåŠŸ:', savePath);

// âœ… æ·»åŠ çŠ¶æ€æ›´æ–°
setLastSavedPath(savePath);
options.onSaveSuccess?.(savePath);

// âœ… æ˜¾ç¤ºæˆåŠŸæç¤º
success('ä¿å­˜æˆåŠŸ', `å›¾ç‰‡å·²ä¿å­˜åˆ°: ${savePath}`, { duration: 5000 });

return savePath;
```

### çŠ¶æ€æµç¨‹ï¼ˆä¿®å¤åï¼‰
1. ç”¨æˆ·ç‚¹å‡»ä¸‹è½½ â†’ `onSaveStart()` â†’ æ˜¾ç¤º"æ­£åœ¨ä¿å­˜å›¾ç‰‡..."
2. ä¿å­˜æˆåŠŸ â†’ `onSaveSuccess()` â†’ æ˜¾ç¤º"å›¾ç‰‡å·²ä¿å­˜åˆ°: ..."
3. 3ç§’åè‡ªåŠ¨æ¸…é™¤æˆåŠŸçŠ¶æ€ â†’ å›åˆ°ç©ºé—²çŠ¶æ€

## ğŸ¯ ä¿®å¤æ•ˆæœ

### âœ… ä¿®å¤å‰çš„é—®é¢˜
- ä¿å­˜æˆåŠŸåçŠ¶æ€æ ä¸€ç›´æ˜¾ç¤º"ä¿å­˜ä¸­"
- ç”¨æˆ·ä¸çŸ¥é“ä¿å­˜æ˜¯å¦çœŸçš„æˆåŠŸ
- éœ€è¦æ‰‹åŠ¨æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿç¡®è®¤ä¿å­˜ç»“æœ

### âœ… ä¿®å¤åçš„ä½“éªŒ
- ä¿å­˜æˆåŠŸåç«‹å³æ˜¾ç¤º"å›¾ç‰‡å·²ä¿å­˜åˆ°: [è·¯å¾„]"
- åŒæ—¶æ˜¾ç¤º Toast é€šçŸ¥ç¡®è®¤ä¿å­˜æˆåŠŸ
- 3ç§’åçŠ¶æ€è‡ªåŠ¨æ¸…é™¤ï¼Œå›åˆ°æ­£å¸¸çŠ¶æ€
- ç”¨æˆ·ä½“éªŒæµç•…ï¼Œåé¦ˆåŠæ—¶

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤
1. å¯åŠ¨åº”ç”¨ï¼š`npm run tauri dev`
2. é€‰æ‹©ä¸€å¼ ç…§ç‰‡ï¼Œè°ƒæ•´ä¸€äº›è®¾ç½®
3. ç‚¹å‡»"ä¸‹è½½å¤„ç†åçš„å›¾ç‰‡"æŒ‰é’®
4. è§‚å¯ŸçŠ¶æ€æ çš„å˜åŒ–

### é¢„æœŸç»“æœ
1. **ç«‹å³æ˜¾ç¤º**ï¼š"æ­£åœ¨ä¿å­˜å›¾ç‰‡..."ï¼ˆè“è‰²åŠ è½½çŠ¶æ€ï¼‰
2. **ä¿å­˜æˆåŠŸå**ï¼š"å›¾ç‰‡å·²ä¿å­˜åˆ°: [å…·ä½“è·¯å¾„]"ï¼ˆç»¿è‰²æˆåŠŸçŠ¶æ€ï¼‰
3. **åŒæ—¶å¼¹å‡º** Toast é€šçŸ¥ï¼š"ä¿å­˜æˆåŠŸ"
4. **3ç§’å**ï¼šçŠ¶æ€æ è‡ªåŠ¨æ¶ˆå¤±ï¼Œå›åˆ°æ­£å¸¸çŠ¶æ€

### è°ƒè¯•ä¿¡æ¯
åœ¨ Console ä¸­åº”è¯¥çœ‹åˆ°ï¼š
```
ğŸ”„ å¼€å§‹çº¯å‰ç«¯å¤„ç†å¹¶ä¿å­˜å›¾ç‰‡...
ğŸ¨ å¼€å§‹çº¯å‰ç«¯é«˜è´¨é‡å›¾åƒå¤„ç†...
ğŸ“¸ å›¾åƒåŠ è½½å®Œæˆ: 4000x3000
âœ¨ å…ƒæ•°æ®å åŠ å®Œæˆ
ğŸ–¼ï¸ ç›¸æ¡†æ•ˆæœå®Œæˆ
âœ… å‰ç«¯å¤„ç†å®Œæˆï¼Œæ ¼å¼: jpeg, è´¨é‡: 1, å¤§å°: 2048.5KB
âœ… å›¾ç‰‡ä¿å­˜æˆåŠŸ: /path/to/saved/image.jpg
```

## ğŸš€ æŠ€æœ¯ç»†èŠ‚

### çŠ¶æ€ç®¡ç†æµç¨‹
```typescript
// App.tsx ä¸­çš„çŠ¶æ€ç®¡ç†
const { saveImage } = useFileSave({
  onSaveStart: () => setLoading('æ­£åœ¨ä¿å­˜å›¾ç‰‡...'),      // è“è‰²åŠ è½½çŠ¶æ€
  onSaveSuccess: (savedPath) => {
    setSuccess(`å›¾ç‰‡å·²ä¿å­˜åˆ°: ${savedPath}`);           // ç»¿è‰²æˆåŠŸçŠ¶æ€
  },
  onSaveError: (error) => {
    setError(`ä¿å­˜å¤±è´¥: ${error}`);                     // çº¢è‰²é”™è¯¯çŠ¶æ€
  },
  onSaveCancel: () => {
    setIdle();                                         // å›åˆ°ç©ºé—²çŠ¶æ€
  }
});
```

### è‡ªåŠ¨çŠ¶æ€æ¸…é™¤
```typescript
// useAppStatus.ts ä¸­çš„è‡ªåŠ¨æ¸…é™¤é€»è¾‘
useEffect(() => {
  if (currentStatus.type === 'success') {
    const timer = setTimeout(() => {
      setIdle(); // 3ç§’åè‡ªåŠ¨æ¸…é™¤æˆåŠŸçŠ¶æ€
    }, 3000);
    return () => clearTimeout(timer);
  }
}, [currentStatus.type, setIdle]);
```

## ğŸ“‹ ç›¸å…³æ–‡ä»¶

- `src/hooks/useFileSave.ts` - ä¸»è¦ä¿®å¤æ–‡ä»¶
- `src/hooks/useAppStatus.ts` - çŠ¶æ€ç®¡ç†é€»è¾‘
- `src/components/StatusBar/StatusBar.tsx` - çŠ¶æ€æ˜¾ç¤ºç»„ä»¶
- `src/App.tsx` - çŠ¶æ€é›†æˆå’Œä½¿ç”¨

---

**ä¿®å¤å®Œæˆæ—¶é—´**: $(date)
**ä¿®å¤ç±»å‹**: ç”¨æˆ·ä½“éªŒä¼˜åŒ–
**çŠ¶æ€**: å·²ä¿®å¤ï¼Œç­‰å¾…ç”¨æˆ·éªŒè¯"